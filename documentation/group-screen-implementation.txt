Group Tab Context:
In the Group sub Tab of our Dinner Party App in the social tab, users will first see either options to create or join a group if they aren’t already in one, or, if they are, the group’s current status. For non-members, the screen displays buttons to "Create Group" or "Join with a Code." For members, the app shows a group profile card with each member’s profile picture and display name. If a user is a non-leader and the group profile is incomplete, they’ll see a prompt like “Tell your group leader to complete the profile.” Meanwhile, group leaders with incomplete profiles are presented with a screen to upload videos (one per group member) and a “Save” button, which, upon completion, updates the profile and flags the group as live. Both leaders and members can leave the group, and a pull-to-refresh feature ensures that the latest group status is always displayed.

Group Screen Implementation Specification

When a user navigates to the group screen, the app must first determine their group status by querying the group_members table using the current user's ID. If no record is found, the user is not in any group and should see the initial screen with buttons for "Create Group" and "Join Group." Once a group is created or joined, the user’s membership is stored in the group_members table and the group’s state is maintained in the groups table with flags like is_ready, is_live, and is_locked.

For users already in a group, the app should display a group card that shows the profile pictures and display names of all current members. If the user is a non-leader, the card should include a message such as "Tell your group leader to make the profile," and no editing options should be available. For the group leader, if the group's profile is not yet "live" (i.e., the required video uploads corresponding to the number of group members have not been completed), a dedicated profile setup screen should be displayed. This screen must allow the leader to upload the correct number of videos—one for each group member—and include a "Save" button. Upon saving, the app will update the video_links array in the groups table and set the is_live flag to true, causing the complete group profile to appear on the group card.

Additionally, both group leaders and members must have access to a "Leave Group" button that executes the necessary functions to remove the user from the group. This action should also trigger checks (either in the application layer or via a database trigger) to update group state flags, such as reverting is_ready or transferring leadership if the leaving user is the leader. The group screen should also incorporate a pull-to-refresh feature, allowing users to trigger a re-query of the database so that the UI always reflects the most current group state. This implementation will rely on optimized, well-indexed queries against the group_members and groups tables, ensuring smooth performance and robust handling of edge cases such as incomplete profile data, membership drops below the minimum required, or leadership transitions.

